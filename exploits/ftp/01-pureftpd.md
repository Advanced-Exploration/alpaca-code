## Pure-FTPd

Name      | Version
:---------|:--------------
Pure-FTPd | 1.0.47, 1.0.49

The homepage of PureFTPd is https://www.pureftpd.org/.

We used a [Docker image][1] by the GitHub user `jedisct1`, based on
another one by the user `stilliard`.

[1]: https://github.com/jedisct1/pure-ftpd/

Pure-FTPd requires capability support, which is not available in
Docker.  So, a special Docker image is used which compiles pure-ftpd
from source with that option disabled.

```
$ docker run -d --name ftpd_server -p 21:21 -p 30000-30009:30000-30009 -e "PUBLICHOST=localhost" stilliard/pure-ftpd
```

However, we also tested on NixOS with version 1.0.49 and could
reproduce the same results with that version:

```
$ nix-shell -p pure-ftpd; sudo pure-ftpd
```

### HTTP Detection

Pure-FTPd detects and blocks HTTP POST requests.

This protection is disabled if PureFTPd is compiled with the flag
`--enable-minimal` (which is recommended to be used for embedded
systems). Extract from the [source code][2]:

[2]: https://github.com/jedisct1/pure-ftpd/blob/4828633d9cb42cd77d764e7d1cb3d0c04c5df001/src/ftp_parser.c#L429

```
#ifndef MINIMAL
        } else if (!strcmp(cmd, "connect") ||
                   !strcmp(cmd, "delete") ||
                   !strcmp(cmd, "get") ||
                   !strcmp(cmd, "head") ||
                   !strcmp(cmd, "options") ||
                   !strcmp(cmd, "post") ||
                   !strcmp(cmd, "put")) {
            die(500, LOG_INFO, "HTTP command: [%s]", cmd);
        } else if (!strcmp(cmd, "help")) {
            goto help_site;
#endif
```

### Error Tolerance

Yes, at least 100 errors allowed.

### Reflection

Yes, pre-auth.

```
TYPE <script>alert("xss");</script>
504-Unknown TYPE: <script>alert("xss");</script>
```

```
USER <script>alert("xss");</script>
331 User <script>alert("xss");</script> OK. Password required
```

### Additional Notes

Pure-FTPd has support for SNI since version 1.0.48 (March 25, 2019).
