## Dovecot IMAP

Name            | Version
:---------------|:--------------
Dovecot (IMAP)  | 2.4.devel

### HTTP Detection

Dovecot IMAP does not detect HTTP requests.

```
S: * OK [CAPABILITY IMAP4rev1 SASL-IR LOGIN-REFERRALS ID ENABLE IDLE LITERAL+ STARTTLS LOGINDISABLED] Dovecot ready.
C: GET /get HTTP/1.1
S: GET BAD Error in IMAP command received by server.
(...)
```

### Error Tolerance

No, Dovecot aborts the connection after three errors.

### Reflection

No reflection found pre-auth.

Post-auth, a reflection was found in the `SELECT` command (see
below).

```
C: MrogJcxL SELECT {25+}
<script>alert(1)</script>
MrogJcxL NO Mailbox doesn't exist: <script>alert(1)</script> (0.001 + 0.000 secs).
S: 
```

### Additional Notes

In addition to the post-auth reflection in `SELECT`, some more
commands reflect a limited range of characters post-auth.

```
# 1
C: 5tC2DHro APPEND F1SbF2mm (by52U6Nv) {4}
S: 5tC2DHro NO [TRYCREATE] Mailbox doesn't exist: F1SbF2mm (0.001 + 0.000 secs).
   * BAD Error in IMAP command : Unknown command (0.001 + 0.000 secs).
# 3
C: oLwzmRAU DELETE lLD1OZ5m
S: oLwzmRAU NO [NONEXISTENT] Mailbox doesn't exist: lLD1OZ5m (0.010 + 0.000 + 0.009 secs).
# 4
C: iTnRlIKC EXAMINE As7bHlRP
S: iTnRlIKC NO Mailbox doesn't exist: As7bHlRP (0.001 + 0.000 secs).
# 7
C: cEAgkcG5 RENAME 96zafyjR uYLSxc0t
S: cEAgkcG5 NO [NONEXISTENT] Mailbox doesn't exist: 96zafyjR (0.008 + 0.000 + 0.007 secs).
# 8
C: RVf9dGgb SELECT 4DblObyT
S: RVf9dGgb NO Mailbox doesn't exist: 4DblObyT (0.001 + 0.000 secs).
# 9
C: Ssoh6gb8 STATUS CHDkHjkQ (UIDVALIDITY)
S: Ssoh6gb8 NO Mailbox doesn't exist: CHDkHjkQ (0.001 + 0.000 secs).
# 10
C: vELO4cIk SUBSCRIBE Drxr2cdj
S: vELO4cIk NO Mailbox doesn't exist: Drxr2cdj (0.001 + 0.000 secs).
```
